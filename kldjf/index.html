<!DOCTYPE html>
<html>
<head>
    <title>全新骷髅打金服，高攻高爆！爆装不停！</title>
    <script>
        var video;
        var audio;
        var started = false;
        var loadok = false;

        function start() {
            if (loadok){
                if (!started) {
                    var e = false;
                    function playError() {
                        started = false;
                        e = true;
                        console.warn("未启用自动播放，播放音频或视频时出现错误");
                    }
                    started = true
                    video.play().catch(_ => {
                        console.error(_)
                        playError();
                    });
                    if (!e) {
                        audio.play().catch(_ => {
                            console.error(_)
                            playError();
                        });
                    }
                    if (e){
                        started = false
                    }
            
                } else {
                    console.log("无效的触发。原因：已经在播放")
                }
            } else {
                console.log("无效的触发。原因：未加载完成")
            }
        }
        
        function onLoadOk() {
            loadok = true;
            console.log('加载完成');
            start()
        }

        function main(){
            console.log("main启动")
            window.onload = function() {
                video = document.getElementById('video');
                audio = document.getElementById('music');
            
                video.loop = true;
                audio.loop = true;

                document.body.onclick = function() {
                    start()
                }
            }
            start()
            window.addEventListener('load', (event) => {
                onLoadOk()
            });
        }
        main()
    </script>
    <style>
        #video{
            max-width: 100%;
            max-height: 100vh;
            object-fit: contain;
        }
    </style>
</head>
<body>
    <video id="video" maintainAspectRatio>
        <source src="assets/bg.mp4" type="video/mp4">
    </video>
    <audio id="music">
        <source src="assets/bg.mp3" type="audio/mpeg">
    </audio>
    <button></button>
</body>

</html>
